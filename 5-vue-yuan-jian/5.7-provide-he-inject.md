# 5.8 Provide 和 Inject

## Prop Drilling

概念示意圖：

![](<../.gitbook/assets/prop\_drilling (1).png>)



請在 `practice` 資料夾下，建立以下檔案及對應的內容：

{% tabs %}
{% tab title="component9_prop_drilling.html" %}
```html
<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="utf-8">
    <title></title>
  </head>
  <body>

    <div id="myapp">

      <post-content msg="hi"></post-content>
    </div>

    <script src="./vendors/vue/vue.global.js"></script>

    <script type="module">
      import PostContent from "./components/PostContent1.js";

      const app = Vue.createApp({});
      app.component("PostContent", PostContent);


      app.mount("#myapp");
    </script>

  </body>
</html>
```
{% endtab %}

{% tab title="components/PostContent1.js" %}
```javascript
import PostMsg from "./PostMsg1.js";

export default {
  props: ["msg"],
  components: {PostMsg},
  template: `
    <div>
      <h1>文章標題</h1>
      <PostMsg :msg="msg"></PostMsg>
    </div>
  `
}
```
{% endtab %}

{% tab title="components/PostMsg1.js" %}
```javascript
export default {
  props: ["msg"],
  template: `
    <span>{{ msg }}</span>
  `
}
```
{% endtab %}
{% endtabs %}

然後瀏覽 `component9_prop_drilling.html` 頁面。



## Provide 和 Inject 特性

概念示意圖：

![](../.gitbook/assets/provide\_inject.png)



請在 `practice` 資料夾下，建立以下檔案及對應的內容：

{% tabs %}
{% tab title="component9_provide_inject.html" %}
```html
<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="utf-8">
    <title></title>
  </head>
  <body>

    <div id="myapp">

      <post-content></post-content>
    </div>

    <script src="./vendors/vue/vue.global.js"></script>

    <script type="module">
      import PostContent from "./components/PostContent2.js";

      const app = Vue.createApp({
        data(){
          return {
            dynamicMsg: "哈囉"
          };
        },
        provide: {
          msg: "hi",
          msg2: "哈囉" // 這裡可以用 this.dynamicMsg 嗎？不行。
        },
        /*
        provide(){
          return {
            msg: "hi",
            msg2: this.dynamicMsg
          };
        }
        */
      });
      app.component("PostContent", PostContent);

      app.mount("#myapp");
    </script>

  </body>
</html>
```
{% endtab %}

{% tab title="components/PostContent2.js" %}
```javascript
import PostMsg from "./PostMsg2.js";

export default {
  components: {PostMsg},
  template: `
    <div>
      <h1>文章標題</h1>
      <PostMsg></PostMsg>
    </div>
  `
}
```
{% endtab %}

{% tab title="components/PostMsg2.js" %}
```javascript
export default {
  inject: ["msg", "msg2"],
  template: `
    <span>{{ msg }}</span>
    <span>{{ msg2 }}</span>
  `,
  mounted(){
    console.log(this.msg); // 也可以這樣取得 inject 的資料
    console.log(this.msg2);
  }
}
```
{% endtab %}
{% endtabs %}

然後瀏覽 `component9_provide_inject.html` 頁面。



### Inject 自訂 key 名稱

上述的 `components/PostMsg2.js`，改成以下：也就是 **inject** 需使用**物件語法**，來更改 **provide** 傳遞過來的 **key** 名稱。

```javascript
export default {
  inject: {
    alias_msg: {
      from: "msg"
    },
    alias_msg2: {
      from: "msg2"
    },
  },
  template: `
    <span>{{ alias_msg }}</span>
    <span>{{ alias_msg2 }}</span>
  `,
  mounted(){
    console.log(this.alias_msg);
    console.log(this.alias_msg2);
  }
}
```



### Inject 的預設值

將 `components/PostMsg2.js` 的以下內容：

```javascript
inject: {
  alias_msg: {
    from: "msg"
  },
  alias_msg2: {
    from: "msg2"
  },
},
```

改成(留意以下註解)：

```javascript
inject: {
  alias_msg: {
    from: "msg"
  },
  alias_msg2: {
    from: "msg2",
    default: "預設資料" // 如果沒有傳遞 msg2 資料，那 msg2 的預設值可透過 default 來指定
  },
},
```



