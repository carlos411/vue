# 5.2 props



使用 **`props`**，目的是用來將 **資料傳遞給元件**。(即元件上的屬性)

請先建立 `practice` 資料夾下，建立 component2\_props.html 檔案，內容如下：

```html
<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="utf-8">
    <title></title>
  </head>
  <body>
    <div id="my_block">
      <text-only greet-msg="哈囉"></text-only>
    </div>

    <script src="./vendors/vue/vue.global.js"></script>
    <!-- <script src="./vendors/vue/vue.global.prod.js"></script> -->
    
    <script type="module">
      import TextOnly from "./components/TextOnly.js";

      const app = Vue.createApp({});

      app.component("TextOnly", TextOnly);

      app.mount("#my_block");
    </script>
  </body>
</html>
```

## 元件屬性宣告

語法一：使用 `props` 屬性，且是陣列，定義了該元件可以使用 foo 屬性來傳遞資料。

```javascript
export default {
  props: ['foo'],
  data(){
    return {};
  }
}
```

語法二：使用 `props` 屬性，且是物件，定義了該元件可以使用的屬性，分別是 title 和 likes 兩個屬性，且分別有定義資料類型是 String 和 Number：

```javascript
export default {
  props: {
    title: String,
    likes: Number
  },
  data(){
    return {};
  }
}
```



## 元件屬性的細節

以 TextOnly 元件來測試。



### 留意命名寫法

想在 `TextOnly` 元件上，定義一個可以使用的屬性，名稱叫做 `greetMsg`，修改 `TextOnly.js` 為以下：

```javascript
export default {
  // 寫法一：
  props: ["greetMsg"],
  // 寫法二
  // props: {
  //   greetMsg: String
  // },
  
  data(){
    return {};
  },
  mounted(){
    console.log(this.greetMsg);
  },
  template: `
    <p>這是 TextOnly 元件的段落文字</p>
  `
}
```

然後可以在 template 當中直接使用(以及上方程式的 `mounted()` 函式)，故將 template 改成以下：

```html
template: `
  <p>{{ greetMsg }} 這是 TextOnly 元件的段落文字</p>
`
```



這時在載入 TextOnly 元件時，就可以使用 `greet-msg` 屬性：

```html
<text-only greet-msg="哈囉"></text-only>
```



### 靜態與動態



靜態也就是固定的資料，例如以下的 `greetMsg` 屬性(在標籤的屬性上，改成 `greet-msg`)：

```html
<text-only greet-msg="哈囉"></text-only>
```



動態也就是 `greetMsg` 資料會變動，修改 `component2_props.html`，如下：

```html
<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="utf-8">
    <title></title>
  </head>
  <body>
    <div id="my_block">
      <text-only :greet-msg="helloText"></text-only>
    </div>

    <script src="./vendors/vue/vue.global.js"></script>
    <!-- <script src="./vendors/vue/vue.global.prod.js"></script> -->
    
    <script type="module">
      import TextOnly from "./components/TextOnly.js";

      const app = Vue.createApp({
        data(){
          return {
            helloText: "父層元件資料"
          };
        }
      });

      app.component("TextOnly", TextOnly);

      app.mount("#my_block");
    </script>
  </body>
</html>

```

資料變動的示意圖如下：

![](../.gitbook/assets/props\_dynamic.png)



### 資料類型

字串(String)：

```html
<text-only :greet-msg="helloText"></text-only>
```



數值(Number)：

```html
<text-only :greet-msg="10"></text-only>
<text-only :greet-msg="post.likes"></text-only>
```



布靈值(Boolean)：

```html
<text-only is-poblished></text-only>
<text-only :is-poblished></text-only>
```



陣列(Array)：

```html
<text-only :comment-ids="[234, 266, 273]"></text-only>
<text-only :comment-ids="post.commentIds"></text-only>
```



物件(Object)：

```html
<text-only :author="{name: 'name1', company: '公司名稱'}"></text-only>
<text-only :author="post.author"></text-only>
```



使用 `v-bind` 綁定物件(post)上的多個屬性，例如元件檔：

```javascript
export default {
  data() {
    return {
      post: {
        id: 1,
        title: 'My Journey with Vue'
      }
    };
  }
}
```

那使用元件時，可以使用以下：

```html
<text-only v-bind="post"></text-only>
```

等同於：

```html
<text-only :id="post.id" :title="post.title"></text-only>
```



## 單一方向資料流(One-Way Data Flow)

元件上的屬性，是從父層傳遞的，如果試圖想要在子元件中修改資料的話，是會報錯的，例如修改 `TextOnly.js`：

將原來的：

```javascript
mounted(){
  console.log(this.greetMsg);
},
```

改成：

```javascript
mounted(){
  console.log(this.greetMsg);
  this.greetMsg = "test"; // 報錯，這是唯讀，不應修改
},
```

錯誤示意圖如下：

![](../.gitbook/assets/props\_readonly.png)



### props 當做是 data 的初始資料

例：

```javascript
data(){
  return {
    myInitMsg: this.greetMsg
  };
},
```



### props 資料的變形，使用 computed

例：

```javascript
computed: {
  greetMsgLength(){
    return this.greetMsg.length;
  }
},
```



## props 資料上的驗證

props 屬性，使用物件的格式時，可以加上驗證(以 `greetMsg` 為例)，如下：

```javascript
props: {
  greetMsg: Boolean, // 布靈
  
  greetMsg: String, // 字串
  
  greetMsg: Number, // 數值
  
  greetMsg: [String, Number], // 字串或數值皆可
  
  // 字串，且必需要提供
  greetMsg: {
    type: String,
    required: true
  },
  
  // 數值，若未提供，預設值為 100
  greetMsg: {
    type: Number,
    default: 100
  },
  
  // 物件，若未提供，預設值為回傳(return)的物件
  // rawProps 可取得元件上的所有 props，是物件格式
  greetMsg: {
    type: Object,
    default(rawProps) {
      return { message: 'hello' };
    }
  },
  
  // 資料必須是 success、warning、danger 其中一個
  greetMsg: {
    validator(value) {
      return ['success', 'warning', 'danger'].includes(value);
    }
  },
  
  // 函式，若未提供，則 default() 即為預設的函式
  greetMsg: {
    type: Function,
    default() {
      return 'Default function';
    }
  }
}
```

以上若驗證`不通過`，就會在瀏覽器的 Console 中看到 Warning 的警告訊息。





