# 7.1 CommonJS 與 ESM 模組

需要 Node.js 的執行環境，才能測試。

## CommonJS modules 範例

此為舊版的模組寫法，且不是原生支持。



`commonjs.js` 檔案內容如下：

```javascript
exports.formatNumber = function(number) {
  var r_str = "";
  switch(number){
    case 1:
      r_str = "一";
      break;
    case 2:
      r_str = "二";
      break;
    case 3:
      r_str = "三";
      break;
    default:
      r_str = "其它";
  }
  return r_str;
};

// 另一種寫法：
/*
module.exports = function(){
};
*/
```

`test_modules.js` 檔案內容如下：

```javascript
const { formatNumber } = require("./commonjs.js");
// 搭配上面的另一種寫法：
// const formatNumber = require("./commonjs.js");

console.log(formatNumber(5));
```



執行 `test_modules.js`：

```bash
node test_modules.js
```



## ECMAScript modules 範例

新版的模組寫法，即使是網頁前端，也可以使用，是原生就支援的語法。

以下的範例是以 Node.js 的環境為主。



**`ES Module`** 模組檔案的**副檔名**，需使用 **`mjs`**。這樣 node 環境才可以執行；

或者在 `package.json` 檔案中，加上以下，那副檔名就可以直接使用 js 即可：

```javascript
{
  ...
  type: "module"
  ...
}
```



`esmodule.mjs` 檔案內容如下：

```javascript
export function formatNumber(number) {
  var r_str = "";
  switch(number){
    case 1:
      r_str = "一";
      break;
    case 2:
      r_str = "二";
      break;
    case 3:
      r_str = "三";
      break;
    default:
      r_str = "其它";
  }
  return r_str;
};

export default ["Winter", "Spring", "Summer", "Autumn"];
```



`test_module.mjs` 檔案內容如下：

```
import seasons, { formatNumber } from "./esmodule.mjs";

console.log(formatNumber(5));
console.log(seasons);
```



執行 `test_modules.mjs`：

```bash
$ node test_modules.mjs
```



## 資源參考

[https://eloquentjavascript.net/10\_modules.html](https://eloquentjavascript.net/10\_modules.html)

